<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Converting Models to Computation Graphs · AlgebraicPetri.jl</title><meta name="title" content="Converting Models to Computation Graphs · AlgebraicPetri.jl"/><meta property="og:title" content="Converting Models to Computation Graphs · AlgebraicPetri.jl"/><meta property="twitter:title" content="Converting Models to Computation Graphs · AlgebraicPetri.jl"/><meta name="description" content="Documentation for AlgebraicPetri.jl."/><meta property="og:description" content="Documentation for AlgebraicPetri.jl."/><meta property="twitter:description" content="Documentation for AlgebraicPetri.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><script src="../../../assets/analytics.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AlgebraicPetri.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">AlgebraicPetri.jl</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../predation/lotka-volterra/">Lotka-Volterra Model</a></li><li><a class="tocitem" href="../epidemiology/">Basic Epidemiology Models</a></li><li><a class="tocitem" href="../../enzymes/enzyme_reactions/">Cathepsin Enzyme Reactions</a></li><li class="is-active"><a class="tocitem" href>Converting Models to Computation Graphs</a></li><li><a class="tocitem" href="../stratification/">Stratification of COVID Models</a></li><li><a class="tocitem" href="../disease_strains/">Multiple-Strain Model of COVID and Vaccines</a></li><li><a class="tocitem" href="../max_common_subobject/">Maximum Common Sub C-Set</a></li></ul></li><li><a class="tocitem" href="../../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Converting Models to Computation Graphs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Converting Models to Computation Graphs</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/AlgebraicPetri.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/AlgebraicPetri.jl/blob/main/docs/literate/covid/bilayerconversion.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="bilayernetwork_example"><a class="docs-heading-anchor" href="#bilayernetwork_example">Converting Models to Computation Graphs</a><a id="bilayernetwork_example-1"></a><a class="docs-heading-anchor-permalink" href="#bilayernetwork_example" title="Permalink"></a></h1><p><a href="https://nbviewer.jupyter.org/github/AlgebraicJulia/AlgebraicPetri.jl/blob/gh-pages/dev/examples/covid/bilayerconversion.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>using Pkg Pkg.status() Pkg.activate(&quot;.&quot;)</p><p>Pkg.instantiate()</p><p>Pkg.develop(path=&quot;../../&quot;) Pkg.instantiate()</p><pre><code class="language-julia hljs">using AlgebraicPetri
using AlgebraicPetri.Epidemiology
using AlgebraicPetri.BilayerNetworks

using Catlab
using Catlab.CategoricalAlgebra
using Catlab.Graphics
import Catlab.CategoricalAlgebra: migrate!
using Catlab.WiringDiagrams
using Catlab.Programs.RelationalPrograms
display_uwd(ex) = to_graphviz(ex, box_labels=:name, junction_labels=:variable, edge_attrs=Dict(:len=&gt;&quot;.75&quot;));

using PrettyTables
function printsoln(bn::AbstractLabelledBilayerNetwork, soln::Vector)
    pretty_table(soln)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">printsoln (generic function with 1 method)</code></pre><h4 id="SIR-Model:"><a class="docs-heading-anchor" href="#SIR-Model:">SIR Model:</a><a id="SIR-Model:-1"></a><a class="docs-heading-anchor-permalink" href="#SIR-Model:" title="Permalink"></a></h4><p>define model</p><pre><code class="language-julia hljs">sir = @relation (s,i,r) begin
    infection(s,i)
    recovery(i,r)
end
display_uwd(sir)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="276pt" height="198pt"
 viewBox="0.00 0.00 275.96 197.57" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 193.566)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-193.566 271.9631,-193.566 271.9631,4 -4,4"/>
<!-- n1 -->
<g id="box1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="%23000000" cx="67.4138" cy="-88.05" rx="42.2678" ry="18"/>
<text text-anchor="middle" x="67.4138" y="-84.35" font-family="Serif" font-size="14.00" fill="%23000000">infection</text>
</g>
<!-- n6 -->
<!-- junction -->
<g id="junction1" class="node">
<title>n6</title>
<ellipse fill="%23000000" stroke="%23000000" cx="32.506" cy="-44.8038" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="26.006" y="-51.1038" font-family="Serif" font-size="14.00" fill="%23000000">s</text>
</g>
<!-- n1&%2345;&%2345;n6 -->
<g id="edge1" class="edge">
<title>n1&%2345;&%2345;n6</title>
<path fill="none" stroke="%23000000" d="M53.6173,-70.9579C46.2993,-61.8919 38.0832,-51.7132 34.4325,-47.1905"/>
</g>
<!-- n7 -->
<!-- junction -->
<g id="junction2" class="node">
<title>n7</title>
<ellipse fill="%23000000" stroke="%23000000" cx="100.3829" cy="-136.7026" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="95.3829" y="-143.0026" font-family="Serif" font-size="14.00" fill="%23000000">i</text>
</g>
<!-- n1&%2345;&%2345;n7 -->
<g id="edge3" class="edge">
<title>n1&%2345;&%2345;n7</title>
<path fill="none" stroke="%23000000" d="M79.3164,-105.6147C86.6942,-116.5022 95.4022,-129.3525 98.8589,-134.4536"/>
</g>
<!-- n2 -->
<g id="box2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="%23000000" cx="159.1063" cy="-139.5531" rx="42.2678" ry="18"/>
<text text-anchor="middle" x="159.1063" y="-135.8531" font-family="Serif" font-size="14.00" fill="%23000000">recovery</text>
</g>
<!-- n2&%2345;&%2345;n7 -->
<g id="edge4" class="edge">
<title>n2&%2345;&%2345;n7</title>
<path fill="none" stroke="%23000000" d="M116.7407,-137.4966C110.9531,-137.2157 106.0103,-136.9758 103.117,-136.8353"/>
</g>
<!-- n8 -->
<!-- junction -->
<g id="junction3" class="node">
<title>n8</title>
<ellipse fill="%23000000" stroke="%23000000" cx="214.3443" cy="-146.0092" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="208.3443" y="-152.3092" font-family="Serif" font-size="14.00" fill="%23000000">r</text>
</g>
<!-- n2&%2345;&%2345;n8 -->
<g id="edge6" class="edge">
<title>n2&%2345;&%2345;n8</title>
<path fill="none" stroke="%23000000" d="M200.1191,-144.3466C204.9495,-144.9112 209.0588,-145.3914 211.6003,-145.6885"/>
</g>
<!-- n3 -->
<!-- n3&%2345;&%2345;n6 -->
<g id="edge2" class="edge">
<title>n3&%2345;&%2345;n6</title>
<path fill="none" stroke="%23000000" d="M1.0555,-1.269C4.7079,-6.3247 25.3097,-34.8425 31.0317,-42.7631"/>
</g>
<!-- n4 -->
<!-- n4&%2345;&%2345;n7 -->
<g id="edge5" class="edge">
<title>n4&%2345;&%2345;n7</title>
<path fill="none" stroke="%23000000" d="M71.0993,-188.4779C73.9209,-183.4892 93.8705,-148.217 99.1199,-138.9358"/>
</g>
<!-- n5 -->
<!-- n5&%2345;&%2345;n8 -->
<g id="edge7" class="edge">
<title>n5&%2345;&%2345;n8</title>
<path fill="none" stroke="%23000000" d="M266.8665,-158.8031C261.8514,-157.5814 226.667,-149.0109 216.8706,-146.6246"/>
</g>
</g>
</svg>
'/><p>Extract the Petri network form of the model.</p><pre><code class="language-julia hljs">psir = apex(oapply_epi(sir))
psir
to_graphviz(psir)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="376pt" height="48pt"
 viewBox="0.00 0.00 376.00 48.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 44)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-44 372,-44 372,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="18" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">S</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="118,-38 82,-38 82,-2 118,-2 118,-38"/>
<text text-anchor="middle" x="100" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">inf</text>
</g>
<!-- n1&%2345;&gt;n4 -->
<g id="edge5" class="edge">
<title>n1&%2345;&gt;n4</title>
<path fill="none" stroke="%23000000" d="M36.1985,-20C46.6024,-20 59.8785,-20 71.6232,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="71.8524,-23.5001 81.8524,-20 71.8524,-16.5001 71.8524,-23.5001"/>
<text text-anchor="middle" x="59" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="182" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="182" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">I</text>
</g>
<!-- n2&%2345;&gt;n4 -->
<g id="edge1" class="edge">
<title>n2&%2345;&gt;n4</title>
<path fill="none" stroke="%23000000" d="M167.4244,-9.3494C158.5429,-4.1203 146.8502,.5614 136,-2 133.1309,-2.6773 130.2298,-3.6202 127.3851,-4.7228"/>
<polygon fill="%23000000" stroke="%23000000" points="125.7337,-1.6281 118.0594,-8.9325 128.6138,-8.0081 125.7337,-1.6281"/>
<text text-anchor="middle" x="141" y="-5.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="286,-40 246,-40 246,0 286,0 286,-40"/>
<text text-anchor="middle" x="266" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">rec</text>
</g>
<!-- n2&%2345;&gt;n5 -->
<g id="edge2" class="edge">
<title>n2&%2345;&gt;n5</title>
<path fill="none" stroke="%23000000" d="M200.2267,-20C210.4969,-20 223.5949,-20 235.3947,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="235.748,-23.5001 245.7479,-20 235.7479,-16.5001 235.748,-23.5001"/>
<text text-anchor="middle" x="223" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="350" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="350" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">R</text>
</g>
<!-- n4&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n4&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" d="M118.1985,-20C128.6024,-20 141.8785,-20 153.6232,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="153.8524,-23.5001 163.8524,-20 153.8524,-16.5001 153.8524,-23.5001"/>
<text text-anchor="middle" x="141" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">2</text>
</g>
<!-- n5&%2345;&gt;n3 -->
<g id="edge4" class="edge">
<title>n5&%2345;&gt;n3</title>
<path fill="none" stroke="%23000000" d="M286.3341,-20C296.966,-20 310.1488,-20 321.7558,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="321.8541,-23.5001 331.8541,-20 321.854,-16.5001 321.8541,-23.5001"/>
<text text-anchor="middle" x="309" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
</g>
</svg>
'/><p>Convert the Petri network into a bilayer network and draw it. This model uses a computation graph to express the computation of the vector field of the Petri net.</p><pre><code class="language-julia hljs">bnsir = BilayerNetwork()
migrate!(bnsir, psir)
bnsir
to_graphviz(bnsir)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="241pt" height="204pt"
 viewBox="0.00 0.00 240.84 203.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 199.6812)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-199.6812 236.8406,-199.6812 236.8406,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<path fill="%23e28f41" stroke="%23e28f41" d="M103.3345,-118.669C103.3345,-118.669 73.3345,-118.669 73.3345,-118.669 67.3345,-118.669 61.3345,-112.669 61.3345,-106.669 61.3345,-106.669 61.3345,-94.669 61.3345,-94.669 61.3345,-88.669 67.3345,-82.669 73.3345,-82.669 73.3345,-82.669 103.3345,-82.669 103.3345,-82.669 109.3345,-82.669 115.3345,-88.669 115.3345,-94.669 115.3345,-94.669 115.3345,-106.669 115.3345,-106.669 115.3345,-112.669 109.3345,-118.669 103.3345,-118.669"/>
<text text-anchor="middle" x="88.3345" y="-96.969" font-family="Times,serif" font-size="14.00" fill="%23000000">p[1]</text>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="23.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="23.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[1]&%2339;</text>
</g>
<!-- n1&%2345;&gt;n6 -->
<g id="edge7" class="edge">
<title>n1&%2345;&gt;n6</title>
<path fill="none" stroke="%23ff0000" d="M72.9304,-82.3418C63.5538,-71.1859 51.523,-56.8721 41.659,-45.1363"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="42.9606,-43.965 38.4038,-41.2634 40.2813,-46.217 42.9606,-43.965"/>
</g>
<!-- n7 -->
<g id="node7" class="node">
<title>n7</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="88.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="88.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[2]&%2339;</text>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge4" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23000000" d="M76.6547,-82.3418C74.6678,-72.2851 74.3076,-59.6621 75.574,-48.6749"/>
<polygon fill="%23000000" stroke="%23000000" points="77.3485,-48.6288 76.3264,-43.4309 73.8839,-48.1317 77.3485,-48.6288"/>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge5" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23000000" d="M88.3345,-82.3418C88.3345,-73.2894 88.3345,-62.1576 88.3345,-52.0112"/>
<polygon fill="%23000000" stroke="%23000000" points="90.0846,-51.8113 88.3345,-46.8113 86.5846,-51.8114 90.0846,-51.8113"/>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge8" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23ff0000" d="M100.0144,-82.3418C102.0012,-72.2851 102.3615,-59.6621 101.095,-48.6749"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="102.7851,-48.1317 100.3427,-43.4309 99.3206,-48.6288 102.7851,-48.1317"/>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<path fill="%23e28f41" stroke="%23e28f41" d="M175.3345,-118.669C175.3345,-118.669 145.3345,-118.669 145.3345,-118.669 139.3345,-118.669 133.3345,-112.669 133.3345,-106.669 133.3345,-106.669 133.3345,-94.669 133.3345,-94.669 133.3345,-88.669 139.3345,-82.669 145.3345,-82.669 145.3345,-82.669 175.3345,-82.669 175.3345,-82.669 181.3345,-82.669 187.3345,-88.669 187.3345,-94.669 187.3345,-94.669 187.3345,-106.669 187.3345,-106.669 187.3345,-112.669 181.3345,-118.669 175.3345,-118.669"/>
<text text-anchor="middle" x="160.3345" y="-96.969" font-family="Times,serif" font-size="14.00" fill="%23000000">p[2]</text>
</g>
<!-- n2&%2345;&gt;n7 -->
<g id="edge9" class="edge">
<title>n2&%2345;&gt;n7</title>
<path fill="none" stroke="%23ff0000" d="M143.2715,-82.3418C132.6609,-70.9451 118.9821,-56.2528 107.9283,-44.38"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="108.9765,-42.9376 104.2885,-40.4706 106.4148,-45.3226 108.9765,-42.9376"/>
</g>
<!-- n8 -->
<g id="node8" class="node">
<title>n8</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="160.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="160.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[3]&%2339;</text>
</g>
<!-- n2&%2345;&gt;n8 -->
<g id="edge6" class="edge">
<title>n2&%2345;&gt;n8</title>
<path fill="none" stroke="%23000000" d="M160.3345,-82.3418C160.3345,-73.2894 160.3345,-62.1576 160.3345,-52.0112"/>
<polygon fill="%23000000" stroke="%23000000" points="162.0846,-51.8113 160.3345,-46.8113 158.5846,-51.8114 162.0846,-51.8113"/>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="88.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="88.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[1]</text>
</g>
<!-- n3&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n3&%2345;&gt;n1</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M88.3345,-154.421C88.3345,-144.9752 88.3345,-133.7558 88.3345,-124.0168"/>
<polygon fill="%23000000" stroke="%23000000" points="90.0846,-123.7792 88.3345,-118.7792 86.5846,-123.7792 90.0846,-123.7792"/>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="153.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="153.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[2]</text>
</g>
<!-- n4&%2345;&gt;n1 -->
<g id="edge2" class="edge">
<title>n4&%2345;&gt;n1</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M139.5497,-159.3743C130.2419,-148.7053 117.8275,-134.4753 107.5524,-122.6975"/>
<polygon fill="%23000000" stroke="%23000000" points="108.7631,-121.4232 104.1574,-118.806 106.1257,-123.7242 108.7631,-121.4232"/>
</g>
<!-- n4&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n4&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M155.2844,-154.421C156.1719,-144.9752 157.226,-133.7558 158.141,-124.0168"/>
<polygon fill="%23000000" stroke="%23000000" points="159.9076,-123.921 158.633,-118.7792 156.4229,-123.5935 159.9076,-123.921"/>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="212.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="212.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[3]</text>
</g>
</g>
</svg>
'/><p>We can hand code a Bilayer netowork using the <code>@acset</code> macro provided by Catlab. As you can see from the code, there is a lot of typing to specify the incidence of all these wires. The Petri Net is more compact. This notion of Bilayer network comes from the definition of mass action kinetics for reaction networks.</p><p>hand coded Bilayer network</p><pre><code class="language-julia hljs">bnsir_test = @acset BilayerNetwork begin
    Qin = 3
    Qout = 3
    Win = 3
    Wa = 3
    Wn = 3
    Box = 2
    arg = [1,2,2]
    call = [1,1,2]
    efflux = [1,1,2]
    effusion = [1,2,2]
    influx = [1,1,2]
    infusion = [2,2,3]
end

@assert bnsir == bnsir_test

function roundtrip(pn::AbstractPetriNet, bn::AbstractBilayerNetwork)
    roundtrippetri = PetriNet()
    migrate!(roundtrippetri, bn)
    pn_structure = PetriNet()
    copy_parts!(pn_structure, pn)
    return roundtrippetri, pn_structure
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">roundtrip (generic function with 1 method)</code></pre><p>We can specify the SEIR model with the relation macro and functorial semantics as usual.</p><pre><code class="language-julia hljs">seir = @relation (s,e,i,r) begin
    exposure(s,i,e)
    illness(e,i)
    recovery(i,r)
end

pseir = apex(oapply_epi(seir))</code></pre><div class="c-set">
<span class="c-set-summary">LabelledPetriNet {T:3, S:4, I:4, O:4, Name:0}</span>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">T</th>
      <th style = "text-align: right;">tname</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">exp</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">ill</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">rec</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">S</th>
      <th style = "text-align: right;">sname</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">S</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">I</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">E</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">R</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">I</th>
      <th style = "text-align: right;">it</th>
      <th style = "text-align: right;">is</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">O</th>
      <th style = "text-align: right;">ot</th>
      <th style = "text-align: right;">os</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">4</td>
    </tr>
  </tbody>
</table>
</div>
<p>By converting this to a Bilayer network, we are able to visualize differences in the computational pattern of data flow between different reaction network models.</p><pre><code class="language-julia hljs">bnseir = BilayerNetwork()
migrate!(bnseir, pseir)

bnrt,pnstr = roundtrip(pseir, bnseir)

display_uwd(sir)

to_graphviz(psir)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="376pt" height="48pt"
 viewBox="0.00 0.00 376.00 48.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 44)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-44 372,-44 372,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="18" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">S</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="118,-38 82,-38 82,-2 118,-2 118,-38"/>
<text text-anchor="middle" x="100" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">inf</text>
</g>
<!-- n1&%2345;&gt;n4 -->
<g id="edge5" class="edge">
<title>n1&%2345;&gt;n4</title>
<path fill="none" stroke="%23000000" d="M36.1985,-20C46.6024,-20 59.8785,-20 71.6232,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="71.8524,-23.5001 81.8524,-20 71.8524,-16.5001 71.8524,-23.5001"/>
<text text-anchor="middle" x="59" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="182" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="182" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">I</text>
</g>
<!-- n2&%2345;&gt;n4 -->
<g id="edge1" class="edge">
<title>n2&%2345;&gt;n4</title>
<path fill="none" stroke="%23000000" d="M167.4244,-9.3494C158.5429,-4.1203 146.8502,.5614 136,-2 133.1309,-2.6773 130.2298,-3.6202 127.3851,-4.7228"/>
<polygon fill="%23000000" stroke="%23000000" points="125.7337,-1.6281 118.0594,-8.9325 128.6138,-8.0081 125.7337,-1.6281"/>
<text text-anchor="middle" x="141" y="-5.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="286,-40 246,-40 246,0 286,0 286,-40"/>
<text text-anchor="middle" x="266" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">rec</text>
</g>
<!-- n2&%2345;&gt;n5 -->
<g id="edge2" class="edge">
<title>n2&%2345;&gt;n5</title>
<path fill="none" stroke="%23000000" d="M200.2267,-20C210.4969,-20 223.5949,-20 235.3947,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="235.748,-23.5001 245.7479,-20 235.7479,-16.5001 235.748,-23.5001"/>
<text text-anchor="middle" x="223" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="350" cy="-20" rx="18" ry="18"/>
<text text-anchor="middle" x="350" y="-16.3" font-family="Times,serif" font-size="14.00" fill="%23000000">R</text>
</g>
<!-- n4&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n4&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" d="M118.1985,-20C128.6024,-20 141.8785,-20 153.6232,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="153.8524,-23.5001 163.8524,-20 153.8524,-16.5001 153.8524,-23.5001"/>
<text text-anchor="middle" x="141" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">2</text>
</g>
<!-- n5&%2345;&gt;n3 -->
<g id="edge4" class="edge">
<title>n5&%2345;&gt;n3</title>
<path fill="none" stroke="%23000000" d="M286.3341,-20C296.966,-20 310.1488,-20 321.7558,-20"/>
<polygon fill="%23000000" stroke="%23000000" points="321.8541,-23.5001 331.8541,-20 321.854,-16.5001 321.8541,-23.5001"/>
<text text-anchor="middle" x="309" y="-23.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
</g>
</svg>
'/><pre><code class="language-julia hljs">to_graphviz(bnsir)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="241pt" height="204pt"
 viewBox="0.00 0.00 240.84 203.68" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 199.6812)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-199.6812 236.8406,-199.6812 236.8406,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<path fill="%23e28f41" stroke="%23e28f41" d="M103.3345,-118.669C103.3345,-118.669 73.3345,-118.669 73.3345,-118.669 67.3345,-118.669 61.3345,-112.669 61.3345,-106.669 61.3345,-106.669 61.3345,-94.669 61.3345,-94.669 61.3345,-88.669 67.3345,-82.669 73.3345,-82.669 73.3345,-82.669 103.3345,-82.669 103.3345,-82.669 109.3345,-82.669 115.3345,-88.669 115.3345,-94.669 115.3345,-94.669 115.3345,-106.669 115.3345,-106.669 115.3345,-112.669 109.3345,-118.669 103.3345,-118.669"/>
<text text-anchor="middle" x="88.3345" y="-96.969" font-family="Times,serif" font-size="14.00" fill="%23000000">p[1]</text>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="23.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="23.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[1]&%2339;</text>
</g>
<!-- n1&%2345;&gt;n6 -->
<g id="edge7" class="edge">
<title>n1&%2345;&gt;n6</title>
<path fill="none" stroke="%23ff0000" d="M72.9304,-82.3418C63.5538,-71.1859 51.523,-56.8721 41.659,-45.1363"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="42.9606,-43.965 38.4038,-41.2634 40.2813,-46.217 42.9606,-43.965"/>
</g>
<!-- n7 -->
<g id="node7" class="node">
<title>n7</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="88.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="88.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[2]&%2339;</text>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge4" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23000000" d="M76.6547,-82.3418C74.6678,-72.2851 74.3076,-59.6621 75.574,-48.6749"/>
<polygon fill="%23000000" stroke="%23000000" points="77.3485,-48.6288 76.3264,-43.4309 73.8839,-48.1317 77.3485,-48.6288"/>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge5" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23000000" d="M88.3345,-82.3418C88.3345,-73.2894 88.3345,-62.1576 88.3345,-52.0112"/>
<polygon fill="%23000000" stroke="%23000000" points="90.0846,-51.8113 88.3345,-46.8113 86.5846,-51.8114 90.0846,-51.8113"/>
</g>
<!-- n1&%2345;&gt;n7 -->
<g id="edge8" class="edge">
<title>n1&%2345;&gt;n7</title>
<path fill="none" stroke="%23ff0000" d="M100.0144,-82.3418C102.0012,-72.2851 102.3615,-59.6621 101.095,-48.6749"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="102.7851,-48.1317 100.3427,-43.4309 99.3206,-48.6288 102.7851,-48.1317"/>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<path fill="%23e28f41" stroke="%23e28f41" d="M175.3345,-118.669C175.3345,-118.669 145.3345,-118.669 145.3345,-118.669 139.3345,-118.669 133.3345,-112.669 133.3345,-106.669 133.3345,-106.669 133.3345,-94.669 133.3345,-94.669 133.3345,-88.669 139.3345,-82.669 145.3345,-82.669 145.3345,-82.669 175.3345,-82.669 175.3345,-82.669 181.3345,-82.669 187.3345,-88.669 187.3345,-94.669 187.3345,-94.669 187.3345,-106.669 187.3345,-106.669 187.3345,-112.669 181.3345,-118.669 175.3345,-118.669"/>
<text text-anchor="middle" x="160.3345" y="-96.969" font-family="Times,serif" font-size="14.00" fill="%23000000">p[2]</text>
</g>
<!-- n2&%2345;&gt;n7 -->
<g id="edge9" class="edge">
<title>n2&%2345;&gt;n7</title>
<path fill="none" stroke="%23ff0000" d="M143.2715,-82.3418C132.6609,-70.9451 118.9821,-56.2528 107.9283,-44.38"/>
<polygon fill="%23ff0000" stroke="%23ff0000" points="108.9765,-42.9376 104.2885,-40.4706 106.4148,-45.3226 108.9765,-42.9376"/>
</g>
<!-- n8 -->
<g id="node8" class="node">
<title>n8</title>
<ellipse fill="%2380be63" stroke="%2380be63" cx="160.3345" cy="-23.3345" rx="23.1702" ry="23.1702"/>
<text text-anchor="middle" x="160.3345" y="-19.6345" font-family="Times,serif" font-size="14.00" fill="%23000000">u[3]&%2339;</text>
</g>
<!-- n2&%2345;&gt;n8 -->
<g id="edge6" class="edge">
<title>n2&%2345;&gt;n8</title>
<path fill="none" stroke="%23000000" d="M160.3345,-82.3418C160.3345,-73.2894 160.3345,-62.1576 160.3345,-52.0112"/>
<polygon fill="%23000000" stroke="%23000000" points="162.0846,-51.8113 160.3345,-46.8113 158.5846,-51.8114 162.0846,-51.8113"/>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="88.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="88.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[1]</text>
</g>
<!-- n3&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n3&%2345;&gt;n1</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M88.3345,-154.421C88.3345,-144.9752 88.3345,-133.7558 88.3345,-124.0168"/>
<polygon fill="%23000000" stroke="%23000000" points="90.0846,-123.7792 88.3345,-118.7792 86.5846,-123.7792 90.0846,-123.7792"/>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="153.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="153.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[2]</text>
</g>
<!-- n4&%2345;&gt;n1 -->
<g id="edge2" class="edge">
<title>n4&%2345;&gt;n1</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M139.5497,-159.3743C130.2419,-148.7053 117.8275,-134.4753 107.5524,-122.6975"/>
<polygon fill="%23000000" stroke="%23000000" points="108.7631,-121.4232 104.1574,-118.806 106.1257,-123.7242 108.7631,-121.4232"/>
</g>
<!-- n4&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n4&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" stroke-dasharray="5,2" d="M155.2844,-154.421C156.1719,-144.9752 157.226,-133.7558 158.141,-124.0168"/>
<polygon fill="%23000000" stroke="%23000000" points="159.9076,-123.921 158.633,-118.7792 156.4229,-123.5935 159.9076,-123.921"/>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="212.3345" cy="-175.1751" rx="20.5122" ry="20.5122"/>
<text text-anchor="middle" x="212.3345" y="-171.4751" font-family="Times,serif" font-size="14.00" fill="%23000000">u[3]</text>
</g>
</g>
</svg>
'/><pre><code class="language-julia hljs">to_graphviz(bnseir)</code></pre><img src="d252a7a0.svg" alt="Example block output"/><pre><code class="language-julia hljs">to_graphviz(bnrt)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="536pt" height="112pt"
 viewBox="0.00 0.00 536.00 112.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 108)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-108 532,-108 532,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="18" cy="-64" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-60.3" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="118,-82 82,-82 82,-46 118,-46 118,-82"/>
<text text-anchor="middle" x="100" y="-60.3" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n1&%2345;&gt;n5 -->
<g id="edge8" class="edge">
<title>n1&%2345;&gt;n5</title>
<path fill="none" stroke="%23000000" d="M36.1985,-64C46.6024,-64 59.8785,-64 71.6232,-64"/>
<polygon fill="%23000000" stroke="%23000000" points="71.8524,-67.5001 81.8524,-64 71.8524,-60.5001 71.8524,-67.5001"/>
<text text-anchor="middle" x="59" y="-67.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="346" cy="-64" rx="18" ry="18"/>
<text text-anchor="middle" x="346" y="-60.3" font-family="Times,serif" font-size="14.00" fill="%23000000">2</text>
</g>
<!-- n2&%2345;&gt;n5 -->
<g id="edge2" class="edge">
<title>n2&%2345;&gt;n5</title>
<path fill="none" stroke="%23000000" d="M327.8845,-64C285.475,-64 179.4792,-64 128.3992,-64"/>
<polygon fill="%23000000" stroke="%23000000" points="128.089,-60.5001 118.089,-64 128.0889,-67.5001 128.089,-60.5001"/>
<text text-anchor="middle" x="223" y="-67.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n7 -->
<g id="node7" class="node">
<title>n7</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="446,-82 410,-82 410,-46 446,-46 446,-82"/>
<text text-anchor="middle" x="428" y="-60.3" font-family="Times,serif" font-size="14.00" fill="%23000000">3</text>
</g>
<!-- n2&%2345;&gt;n7 -->
<g id="edge7" class="edge">
<title>n2&%2345;&gt;n7</title>
<path fill="none" stroke="%23000000" d="M364.1985,-64C374.6024,-64 387.8785,-64 399.6232,-64"/>
<polygon fill="%23000000" stroke="%23000000" points="399.8524,-67.5001 409.8524,-64 399.8524,-60.5001 399.8524,-67.5001"/>
<text text-anchor="middle" x="387" y="-67.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="182" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="182" y="-14.3" font-family="Times,serif" font-size="14.00" fill="%23000000">3</text>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<polygon fill="%23e28f41" stroke="%23e28f41" points="282,-36 246,-36 246,0 282,0 282,-36"/>
<text text-anchor="middle" x="264" y="-14.3" font-family="Times,serif" font-size="14.00" fill="%23000000">2</text>
</g>
<!-- n3&%2345;&gt;n6 -->
<g id="edge5" class="edge">
<title>n3&%2345;&gt;n6</title>
<path fill="none" stroke="%23000000" d="M200.1985,-18C210.6024,-18 223.8785,-18 235.6232,-18"/>
<polygon fill="%23000000" stroke="%23000000" points="235.8524,-21.5001 245.8524,-18 235.8524,-14.5001 235.8524,-21.5001"/>
<text text-anchor="middle" x="223" y="-21.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="%236c9ac3" stroke="%236c9ac3" cx="510" cy="-64" rx="18" ry="18"/>
<text text-anchor="middle" x="510" y="-60.3" font-family="Times,serif" font-size="14.00" fill="%23000000">4</text>
</g>
<!-- n5&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n5&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" d="M118.3152,-72.5307C123.8758,-74.7328 130.0821,-76.8149 136,-78 211.8279,-93.1847 234.1721,-93.1847 310,-78 313.2877,-77.3416 316.6645,-76.4064 319.97,-75.3275"/>
<polygon fill="%23000000" stroke="%23000000" points="321.351,-78.5485 329.5131,-71.7934 318.92,-71.9841 321.351,-78.5485"/>
<text text-anchor="middle" x="223" y="-92.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n5&%2345;&gt;n3 -->
<g id="edge6" class="edge">
<title>n5&%2345;&gt;n3</title>
<path fill="none" stroke="%23000000" d="M118.2264,-47.4271C123.6837,-43.0009 129.8572,-38.4851 136,-35 141.8316,-31.6915 148.4284,-28.8098 154.7676,-26.4054"/>
<polygon fill="%23000000" stroke="%23000000" points="156.0986,-29.6475 164.3704,-23.0273 153.7756,-23.0442 156.0986,-29.6475"/>
<text text-anchor="middle" x="141" y="-38.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n6&%2345;&gt;n2 -->
<g id="edge4" class="edge">
<title>n6&%2345;&gt;n2</title>
<path fill="none" stroke="%23000000" d="M282.0722,-23.1723C290.8058,-26.0433 301.2618,-30.0425 310,-35 315.0608,-37.8712 320.1425,-41.4421 324.8274,-45.086"/>
<polygon fill="%23000000" stroke="%23000000" points="322.7929,-47.9443 332.7412,-51.5887 327.2369,-42.5359 322.7929,-47.9443"/>
<text text-anchor="middle" x="305" y="-38.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
<!-- n7&%2345;&gt;n4 -->
<g id="edge1" class="edge">
<title>n7&%2345;&gt;n4</title>
<path fill="none" stroke="%23000000" d="M446.1985,-64C456.6024,-64 469.8785,-64 481.6232,-64"/>
<polygon fill="%23000000" stroke="%23000000" points="481.8524,-67.5001 491.8524,-64 481.8524,-60.5001 481.8524,-67.5001"/>
<text text-anchor="middle" x="469" y="-67.8" font-family="Times,serif" font-size="14.00" fill="%23000000">1</text>
</g>
</g>
</svg>
'/><pre><code class="language-julia hljs">qm = @relation (s,q) begin
    exposure(s,i,e)
    illness(e,i)
    recovery(i,r)
    quarexp(e,q)
    quarinf(i,q)
end
display_uwd(qm)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="322pt" height="260pt"
 viewBox="0.00 0.00 321.98 260.32" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 256.3166)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-256.3166 317.9835,-256.3166 317.9835,4 -4,4"/>
<!-- n1 -->
<g id="box1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="%23000000" cx="202.5145" cy="-165.0831" rx="43.6222" ry="18"/>
<text text-anchor="middle" x="202.5145" y="-161.3831" font-family="Serif" font-size="14.00" fill="%23000000">exposure</text>
</g>
<!-- n8 -->
<!-- junction -->
<g id="junction1" class="node">
<title>n8</title>
<ellipse fill="%23000000" stroke="%23000000" cx="260.7826" cy="-175.2244" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="254.2826" y="-181.5244" font-family="Serif" font-size="14.00" fill="%23000000">s</text>
</g>
<!-- n1&%2345;&%2345;n8 -->
<g id="edge1" class="edge">
<title>n1&%2345;&%2345;n8</title>
<path fill="none" stroke="%23000000" d="M242.6656,-172.0712C249.2891,-173.224 255.0216,-174.2217 258.18,-174.7714"/>
</g>
<!-- n10 -->
<!-- junction -->
<g id="junction3" class="node">
<title>n10</title>
<ellipse fill="%23000000" stroke="%23000000" cx="154.7169" cy="-117.3875" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="149.7169" y="-123.6875" font-family="Serif" font-size="14.00" fill="%23000000">i</text>
</g>
<!-- n1&%2345;&%2345;n10 -->
<g id="edge6" class="edge">
<title>n1&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M185.7972,-148.4015C174.8135,-137.4412 161.5988,-124.2547 156.6834,-119.3499"/>
</g>
<!-- n11 -->
<!-- junction -->
<g id="junction4" class="node">
<title>n11</title>
<ellipse fill="%23000000" stroke="%23000000" cx="162.8761" cy="-217.8774" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="155.8761" y="-224.1774" font-family="Serif" font-size="14.00" fill="%23000000">e</text>
</g>
<!-- n1&%2345;&%2345;n11 -->
<g id="edge10" class="edge">
<title>n1&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M189.5354,-182.37C180.3233,-194.6395 168.864,-209.9021 164.5888,-215.5962"/>
</g>
<!-- n2 -->
<g id="box2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="%23000000" cx="149.623" cy="-166.4237" rx="31.577" ry="18"/>
<text text-anchor="middle" x="149.623" y="-162.7237" font-family="Serif" font-size="14.00" fill="%23000000">illness</text>
</g>
<!-- n2&%2345;&%2345;n10 -->
<g id="edge7" class="edge">
<title>n2&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M151.4908,-148.4429C152.6039,-137.728 153.9036,-125.2162 154.4517,-119.9398"/>
</g>
<!-- n2&%2345;&%2345;n11 -->
<g id="edge11" class="edge">
<title>n2&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M154.2582,-184.4197C157.244,-196.0117 160.8244,-209.9122 162.248,-215.439"/>
</g>
<!-- n3 -->
<g id="box3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="%23000000" cx="162.756" cy="-58.8264" rx="42.2678" ry="18"/>
<text text-anchor="middle" x="162.756" y="-55.1264" font-family="Serif" font-size="14.00" fill="%23000000">recovery</text>
</g>
<!-- n3&%2345;&%2345;n10 -->
<g id="edge8" class="edge">
<title>n3&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M160.2564,-77.0345C158.3759,-90.7333 155.9748,-108.2242 155.0769,-114.7646"/>
</g>
<!-- n12 -->
<!-- junction -->
<g id="junction5" class="node">
<title>n12</title>
<ellipse fill="%23000000" stroke="%23000000" cx="163.6452" cy="-2.5" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="157.6452" y="-8.8" font-family="Serif" font-size="14.00" fill="%23000000">r</text>
</g>
<!-- n3&%2345;&%2345;n12 -->
<g id="edge13" class="edge">
<title>n3&%2345;&%2345;n12</title>
<path fill="none" stroke="%23000000" d="M163.0422,-40.6943C163.2453,-27.8302 163.4991,-11.7543 163.6004,-5.3367"/>
</g>
<!-- n4 -->
<g id="box4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="%23000000" cx="101.5759" cy="-234.3166" rx="39.3809" ry="18"/>
<text text-anchor="middle" x="101.5759" y="-230.6166" font-family="Serif" font-size="14.00" fill="%23000000">quarexp</text>
</g>
<!-- n9 -->
<!-- junction -->
<g id="junction2" class="node">
<title>n9</title>
<ellipse fill="%23000000" stroke="%23000000" cx="57.8804" cy="-187.0285" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="50.3804" y="-193.3285" font-family="Serif" font-size="14.00" fill="%23000000">q</text>
</g>
<!-- n4&%2345;&%2345;n9 -->
<g id="edge3" class="edge">
<title>n4&%2345;&%2345;n9</title>
<path fill="none" stroke="%23000000" d="M86.0475,-217.5114C76.0392,-206.6803 64.0953,-193.7543 59.656,-188.95"/>
</g>
<!-- n4&%2345;&%2345;n11 -->
<g id="edge12" class="edge">
<title>n4&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M135.8105,-225.1357C146.1222,-222.3704 155.8852,-219.7522 160.3443,-218.5564"/>
</g>
<!-- n5 -->
<g id="box5" class="node">
<title>n5</title>
<ellipse fill="none" stroke="%23000000" cx="88.7395" cy="-131.1418" rx="35.1405" ry="18"/>
<text text-anchor="middle" x="88.7395" y="-127.4418" font-family="Serif" font-size="14.00" fill="%23000000">quarinf</text>
</g>
<!-- n5&%2345;&%2345;n9 -->
<g id="edge4" class="edge">
<title>n5&%2345;&%2345;n9</title>
<path fill="none" stroke="%23000000" d="M79.1447,-148.5184C71.926,-161.5916 62.709,-178.2837 59.2625,-184.5254"/>
</g>
<!-- n5&%2345;&%2345;n10 -->
<g id="edge9" class="edge">
<title>n5&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M121.7282,-124.2647C134.3567,-121.632 146.9851,-118.9993 152.211,-117.9099"/>
</g>
<!-- n6 -->
<!-- n6&%2345;&%2345;n8 -->
<g id="edge2" class="edge">
<title>n6&%2345;&%2345;n8</title>
<path fill="none" stroke="%23000000" d="M312.8917,-194.3419C307.916,-192.5164 273.0084,-179.7097 263.2891,-176.1439"/>
</g>
<!-- n7 -->
<!-- n7&%2345;&%2345;n9 -->
<g id="edge5" class="edge">
<title>n7&%2345;&%2345;n9</title>
<path fill="none" stroke="%23000000" d="M1.1444,-196.6696C6.5619,-195.749 44.569,-189.2905 55.1514,-187.4922"/>
</g>
</g>
</svg>
'/><pre><code class="language-julia hljs">import AlgebraicPetri.Epidemiology: exposure_petri, spontaneous_petri
semantics = Dict(
    :infection =&gt; exposure_petri(:S, :I, :I, :inf),
    :exposure  =&gt; exposure_petri(:S, :I, :E, :exp),
    :illness   =&gt; spontaneous_petri(:E,:I,:ill),
    :recovery  =&gt; spontaneous_petri(:I,:R,:rec),
    :death     =&gt; spontaneous_petri(:I,:D,:death),
    :quarexp   =&gt; spontaneous_petri(:E, :Q, :qe),
    :quarinf   =&gt; spontaneous_petri(:I, :Q, :qi),
    :quarrec   =&gt; spontaneous_petri(:Q, :R, :qr)
)
pn_quar = oapply(qm, semantics)  |&gt; apex
to_graphviz(pn_quar)</code></pre><img src="d37c0f32.svg" alt="Example block output"/><pre><code class="language-julia hljs">bnquar = LabelledBilayerNetwork()
migrate!(bnquar, pn_quar)
to_graphviz(bnquar)

qm = @relation (s,i,q) begin
    exposure(s,i,e)
    illness(e,i)
    recovery(i,r)
    quarexp(e,q)
    quarinf(i,q)
    quarrec(q,r)
end
display_uwd(qm)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="246pt" height="328pt"
 viewBox="0.00 0.00 246.33 328.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 324.2827)">
<title>G</title>
<polygon fill="%23ffffff" stroke="transparent" points="-4,4 -4,-324.2827 242.3256,-324.2827 242.3256,4 -4,4"/>
<!-- n1 -->
<g id="box1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="%23000000" cx="137.2335" cy="-114.6839" rx="43.6222" ry="18"/>
<text text-anchor="middle" x="137.2335" y="-110.9839" font-family="Serif" font-size="14.00" fill="%23000000">exposure</text>
</g>
<!-- n10 -->
<!-- junction -->
<g id="junction1" class="node">
<title>n10</title>
<ellipse fill="%23000000" stroke="%23000000" cx="147.8538" cy="-56.5223" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="141.3538" y="-62.8223" font-family="Serif" font-size="14.00" fill="%23000000">s</text>
</g>
<!-- n1&%2345;&%2345;n10 -->
<g id="edge1" class="edge">
<title>n1&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M140.5356,-96.6C143.02,-82.9946 146.192,-65.6231 147.3781,-59.1273"/>
</g>
<!-- n11 -->
<!-- junction -->
<g id="junction2" class="node">
<title>n11</title>
<ellipse fill="%23000000" stroke="%23000000" cx="166.382" cy="-176.2398" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="161.382" y="-182.5398" font-family="Serif" font-size="14.00" fill="%23000000">i</text>
</g>
<!-- n1&%2345;&%2345;n11 -->
<g id="edge3" class="edge">
<title>n1&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M145.6645,-132.4884C152.659,-147.2595 161.9643,-166.9104 165.2078,-173.7601"/>
</g>
<!-- n13 -->
<!-- junction -->
<g id="junction4" class="node">
<title>n13</title>
<ellipse fill="%23000000" stroke="%23000000" cx="71.6892" cy="-133.4463" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="64.6892" y="-139.7463" font-family="Serif" font-size="14.00" fill="%23000000">e</text>
</g>
<!-- n1&%2345;&%2345;n13 -->
<g id="edge12" class="edge">
<title>n1&%2345;&%2345;n13</title>
<path fill="none" stroke="%23000000" d="M101.3929,-124.9434C89.9165,-128.2286 78.9463,-131.3689 74.1785,-132.7337"/>
</g>
<!-- n2 -->
<g id="box2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="%23000000" cx="119.7978" cy="-152.815" rx="31.577" ry="18"/>
<text text-anchor="middle" x="119.7978" y="-149.115" font-family="Serif" font-size="14.00" fill="%23000000">illness</text>
</g>
<!-- n2&%2345;&%2345;n11 -->
<g id="edge4" class="edge">
<title>n2&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M143.6358,-164.8019C151.8736,-168.9443 160.0203,-173.0409 163.9512,-175.0175"/>
</g>
<!-- n2&%2345;&%2345;n13 -->
<g id="edge13" class="edge">
<title>n2&%2345;&%2345;n13</title>
<path fill="none" stroke="%23000000" d="M93.7722,-142.337C85.6249,-139.0569 77.7812,-135.8989 74.0136,-134.3821"/>
</g>
<!-- n3 -->
<g id="box3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="%23000000" cx="195.9419" cy="-232.7585" rx="42.2678" ry="18"/>
<text text-anchor="middle" x="195.9419" y="-229.0585" font-family="Serif" font-size="14.00" fill="%23000000">recovery</text>
</g>
<!-- n3&%2345;&%2345;n11 -->
<g id="edge5" class="edge">
<title>n3&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M186.751,-215.1855C179.8362,-201.9644 171.0074,-185.0835 167.706,-178.7712"/>
</g>
<!-- n14 -->
<!-- junction -->
<g id="junction5" class="node">
<title>n14</title>
<ellipse fill="%23000000" stroke="%23000000" cx="169.3689" cy="-290.3836" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="163.3689" y="-296.6836" font-family="Serif" font-size="14.00" fill="%23000000">r</text>
</g>
<!-- n3&%2345;&%2345;n14 -->
<g id="edge15" class="edge">
<title>n3&%2345;&%2345;n14</title>
<path fill="none" stroke="%23000000" d="M187.6797,-250.6756C181.4636,-264.1555 173.5269,-281.3667 170.5591,-287.8027"/>
</g>
<!-- n4 -->
<g id="box4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="%23000000" cx="39.4404" cy="-189.8557" rx="39.3809" ry="18"/>
<text text-anchor="middle" x="39.4404" y="-186.1557" font-family="Serif" font-size="14.00" fill="%23000000">quarexp</text>
</g>
<!-- n12 -->
<!-- junction -->
<g id="junction3" class="node">
<title>n12</title>
<ellipse fill="%23000000" stroke="%23000000" cx="67.6957" cy="-249.9072" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="60.1957" y="-256.2072" font-family="Serif" font-size="14.00" fill="%23000000">q</text>
</g>
<!-- n4&%2345;&%2345;n12 -->
<g id="edge8" class="edge">
<title>n4&%2345;&%2345;n12</title>
<path fill="none" stroke="%23000000" d="M47.7651,-207.5484C54.537,-221.9407 63.4618,-240.909 66.5706,-247.5161"/>
</g>
<!-- n4&%2345;&%2345;n13 -->
<g id="edge14" class="edge">
<title>n4&%2345;&%2345;n13</title>
<path fill="none" stroke="%23000000" d="M49.4673,-172.3166C57.0111,-159.1211 66.6431,-142.2729 70.2448,-135.9727"/>
</g>
<!-- n5 -->
<g id="box5" class="node">
<title>n5</title>
<ellipse fill="none" stroke="%23000000" cx="119.3595" cy="-219.6782" rx="35.1405" ry="18"/>
<text text-anchor="middle" x="119.3595" y="-215.9782" font-family="Serif" font-size="14.00" fill="%23000000">quarinf</text>
</g>
<!-- n5&%2345;&%2345;n11 -->
<g id="edge6" class="edge">
<title>n5&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M136.6019,-203.75C147.2962,-193.8709 159.8571,-182.2674 164.5188,-177.9611"/>
</g>
<!-- n5&%2345;&%2345;n12 -->
<g id="edge9" class="edge">
<title>n5&%2345;&%2345;n12</title>
<path fill="none" stroke="%23000000" d="M95.9462,-233.3776C85.694,-239.3762 74.9292,-245.6748 70.1875,-248.4492"/>
</g>
<!-- n6 -->
<g id="box6" class="node">
<title>n6</title>
<ellipse fill="none" stroke="%23000000" cx="106.9513" cy="-302.2827" rx="38.0276" ry="18"/>
<text text-anchor="middle" x="106.9513" y="-298.5827" font-family="Serif" font-size="14.00" fill="%23000000">quarrec</text>
</g>
<!-- n6&%2345;&%2345;n12 -->
<g id="edge10" class="edge">
<title>n6&%2345;&%2345;n12</title>
<path fill="none" stroke="%23000000" d="M94.0975,-285.133C84.9744,-272.9608 73.6258,-257.8193 69.3919,-252.1703"/>
</g>
<!-- n6&%2345;&%2345;n14 -->
<g id="edge16" class="edge">
<title>n6&%2345;&%2345;n14</title>
<path fill="none" stroke="%23000000" d="M142.536,-295.4989C152.8299,-293.5365 162.4758,-291.6977 166.8739,-290.8592"/>
</g>
<!-- n7 -->
<!-- n7&%2345;&%2345;n10 -->
<g id="edge2" class="edge">
<title>n7&%2345;&%2345;n10</title>
<path fill="none" stroke="%23000000" d="M148.5566,-1.1292C148.4895,-6.4184 148.0187,-43.526 147.8876,-53.8579"/>
</g>
<!-- n8 -->
<!-- n8&%2345;&%2345;n11 -->
<g id="edge7" class="edge">
<title>n8&%2345;&%2345;n11</title>
<path fill="none" stroke="%23000000" d="M224.961,-161.7509C219.3167,-163.147 179.4095,-173.0176 168.9087,-175.6149"/>
</g>
<!-- n9 -->
<!-- n9&%2345;&%2345;n12 -->
<g id="edge11" class="edge">
<title>n9&%2345;&%2345;n12</title>
<path fill="none" stroke="%23000000" d="M17.8827,-281.6673C22.6824,-278.6071 56.6177,-256.9704 65.5471,-251.2771"/>
</g>
</g>
</svg>
'/><pre><code class="language-julia hljs">pn_quar = oapply(qm, semantics)  |&gt; apex
to_graphviz(pn_quar)</code></pre><img src="eec3852a.svg" alt="Example block output"/><pre><code class="language-julia hljs">bnquar = LabelledBilayerNetwork()
migrate!(bnquar, pn_quar)
to_graphviz(bnquar)</code></pre><img src="5b742cdf.svg" alt="Example block output"/><pre><code class="language-julia hljs">quarrt = LabelledPetriNet()
migrate!(quarrt, bnquar) |&gt; to_graphviz

bnquar</code></pre><div class="c-set">
<span class="c-set-summary">AlgebraicPetri.BilayerNetworks.LabelledBilayerNetwork {Qin:5, Qout:5, Win:7, Wn:7, Wa:7, Box:6, Name:0}</span>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Qin</th>
      <th style = "text-align: right;">variable</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">S</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">I</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">E</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">R</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">Q</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Qout</th>
      <th style = "text-align: right;">tanvar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">S</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">I</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">E</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">R</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">Q</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Win</th>
      <th style = "text-align: right;">arg</th>
      <th style = "text-align: right;">call</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">1</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">4</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">5</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td>
      <td style = "text-align: right;">5</td>
      <td style = "text-align: right;">6</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Wn</th>
      <th style = "text-align: right;">efflux</th>
      <th style = "text-align: right;">effusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">4</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td>
      <td style = "text-align: right;">5</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td>
      <td style = "text-align: right;">6</td>
      <td style = "text-align: right;">5</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Wa</th>
      <th style = "text-align: right;">influx</th>
      <th style = "text-align: right;">infusion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">4</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">4</td>
      <td style = "text-align: right;">5</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td>
      <td style = "text-align: right;">5</td>
      <td style = "text-align: right;">5</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td>
      <td style = "text-align: right;">6</td>
      <td style = "text-align: right;">4</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Box</th>
      <th style = "text-align: right;">parameter</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">exp</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">ill</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">rec</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">qe</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">qi</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td>
      <td style = "text-align: right;">qr</td>
    </tr>
  </tbody>
</table>
</div>
<pre><code class="language-julia hljs">import AlgebraicPetri.BilayerNetworks: evaluate!, evaluate

bnsir = LabelledBilayerNetwork()
migrate!(bnsir, psir)

evaluate(bnsir, [10.0, 1, 0.0], inf=0.1, rec=0.3)

evaluate(bnquar, [10.0, 1, 0, 0,0,0], exp=0.1, rec=0.3, qi=0.2, ill=0.7, qe=0.23, qr=0.3)

function euler(bn::AbstractLabelledBilayerNetwork, state, nsteps::Integer, stepsize::Real; params...)
    #preallocate storage so that each step is nonallocating
    #create a storage space for steps of euler&#39;s method store intermediate
    #states as named tuples so that you can integrate with julia Tables.jl data  analysis ecosystem
    du = zeros(length(state))
    ϕ = ones(nparts(bn, :Box))
    u = tuple(state...)
    results = Vector{NamedTuple{tuple(bn[:,:variable]...)}}()
    for i in 1:nsteps
        u = u .+ stepsize.*evaluate!(du, ϕ, bn, u; params...)
        push!(results, NamedTuple{tuple(bn[:,:variable]...)}(u))
    end
    return results
end

soln = euler(bnquar, (S=10.0, I=1, E=0, R=0, Q=0), 30, 0.15, exp=0.1, rec=0.03, qi=0.37, ill=0.7, qe=0.23, qr=0.03)
printsoln(bnquar, soln)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─────────┬──────────┬──────────┬────────────┬──────────┐
│       S │        I │        E │          R │        Q │
├─────────┼──────────┼──────────┼────────────┼──────────┤
│    9.85 │     0.94 │     0.15 │     0.0045 │   0.0555 │
│ 9.71111 │  0.89935 │  0.26796 │ 0.00897975 │ 0.112595 │
│ 9.58011 │ 0.873525 │ 0.361585 │  0.0135335 │ 0.171247 │
│ 9.45458 │  0.85908 │ 0.436671 │   0.018235 │ 0.231432 │
│ 9.33275 │ 0.853385 │ 0.497589 │  0.0231423 │ 0.293134 │
│ 9.21328 │ 0.854429 │ 0.547642 │  0.0283016 │ 0.356345 │
│  9.0952 │ 0.860666 │ 0.589327 │  0.0337501 │ 0.421056 │
│ 8.97778 │ 0.870905 │ 0.624535 │  0.0395178 │  0.48726 │
│  8.8605 │ 0.884227 │ 0.654694 │  0.0456296 │ 0.554949 │
│ 8.74298 │ 0.899916 │ 0.680885 │  0.0521059 │ 0.624113 │
│ 8.62496 │ 0.917414 │ 0.703921 │   0.058964 │ 0.694741 │
│ 8.50627 │ 0.936281 │ 0.724414 │  0.0662187 │ 0.766816 │
│ 8.38681 │ 0.956168 │ 0.742822 │  0.0738826 │ 0.840321 │
│ 8.26652 │ 0.976794 │ 0.759486 │  0.0819668 │ 0.915234 │
│  8.1454 │ 0.997932 │ 0.774658 │   0.090481 │  0.99153 │
│ 8.02347 │   1.0194 │ 0.788522 │  0.0994336 │  1.06918 │
│ 7.90078 │  1.04103 │ 0.801209 │   0.108832 │  1.14815 │
│ 7.77741 │  1.06269 │ 0.812814 │   0.118683 │   1.2284 │
│ 7.65344 │  1.08428 │ 0.823402 │   0.128993 │  1.30989 │
│ 7.52896 │  1.10568 │ 0.833014 │   0.139767 │  1.39258 │
│ 7.40409 │   1.1268 │ 0.841677 │   0.151009 │  1.47642 │
│ 7.27895 │  1.14757 │ 0.849407 │   0.162724 │  1.56135 │
│ 7.15365 │   1.1679 │ 0.856211 │   0.174914 │  1.64732 │
│ 7.02833 │  1.18773 │ 0.862092 │   0.187582 │  1.73427 │
│ 6.90311 │  1.20699 │ 0.867046 │   0.200731 │  1.82212 │
│ 6.77813 │  1.22561 │ 0.871073 │   0.214362 │  1.91083 │
│ 6.65352 │  1.24353 │ 0.874168 │   0.228476 │   2.0003 │
│ 6.52941 │  1.26071 │  0.87633 │   0.243074 │  2.09047 │
│ 6.40594 │  1.27708 │ 0.877557 │   0.258154 │  2.18127 │
│ 6.28322 │   1.2926 │ 0.877852 │   0.273717 │  2.27261 │
└─────────┴──────────┴──────────┴────────────┴──────────┘</code></pre><pre><code class="language-julia hljs">import AlgebraicPetri.BilayerNetworks: compile
compile(bnquar, :du, :ϕ, :u, :p)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">:(f!(du, ϕ, u, p, t) = begin
          <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:281 =#</span>
          begin
              <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:287 =#</span>
              du .= 0.0
              <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:288 =#</span>
              ϕ .= 1.0
              ϕ[1] *= u[1]
              ϕ[1] *= u[2]
              ϕ[2] *= u[3]
              ϕ[3] *= u[2]
              ϕ[4] *= u[3]
              ϕ[5] *= u[2]
              ϕ[6] *= u[5]
              ϕ[1] *= p[:exp]
              ϕ[2] *= p[:ill]
              ϕ[3] *= p[:rec]
              ϕ[4] *= p[:qe]
              ϕ[5] *= p[:qi]
              ϕ[6] *= p[:qr]
              du[1] -= ϕ[1]
              du[2] -= ϕ[1]
              du[3] -= ϕ[2]
              du[2] -= ϕ[3]
              du[3] -= ϕ[4]
              du[2] -= ϕ[5]
              du[5] -= ϕ[6]
              du[3] += ϕ[1]
              du[2] += ϕ[1]
              du[2] += ϕ[2]
              du[4] += ϕ[3]
              du[5] += ϕ[4]
              du[5] += ϕ[5]
              du[4] += ϕ[6]
              return du
          end
      end)</code></pre><pre><code class="language-julia hljs">compile(bnquar, :du, :ϕ, :u, exp=0.1, rec=0.03, qi=0.37, ill=0.7, qe=0.23, qr=0.03)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">:(f!(du, ϕ, u, t) = begin
          <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:282 =#</span>
          begin
              <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:287 =#</span>
              du .= 0.0
              <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:288 =#</span>
              ϕ .= 1.0
              ϕ[1] *= u[1]
              ϕ[1] *= u[2]
              ϕ[2] *= u[3]
              ϕ[3] *= u[2]
              ϕ[4] *= u[3]
              ϕ[5] *= u[2]
              ϕ[6] *= u[5]
              ϕ[1] *= 0.1
              ϕ[2] *= 0.7
              ϕ[3] *= 0.03
              ϕ[4] *= 0.23
              ϕ[5] *= 0.37
              ϕ[6] *= 0.03
              du[1] -= ϕ[1]
              du[2] -= ϕ[1]
              du[3] -= ϕ[2]
              du[2] -= ϕ[3]
              du[3] -= ϕ[4]
              du[2] -= ϕ[5]
              du[5] -= ϕ[6]
              du[3] += ϕ[1]
              du[2] += ϕ[1]
              du[2] += ϕ[2]
              du[4] += ϕ[3]
              du[5] += ϕ[4]
              du[5] += ϕ[5]
              du[4] += ϕ[6]
              return du
          end
      end)</code></pre><pre><code class="language-julia hljs">function eulers(bn::AbstractLabelledBilayerNetwork, funcname::Symbol; params...)
    f = compile(bn, :du, :ϕ, :u; params...)
    varnames = tuple(bn[:,:variable]...)
    nϕ = nparts(bn, :Box)
    quote
    function $funcname(state, nsteps::Integer, stepsize::Real)
        $f
        #preallocate storage so that each step is nonallocating
        du = zeros(length(state))
        ϕ = ones($nϕ)
        u = tuple(state...)
        #create a storage space for steps of euler&#39;s method
        #store intermediate states as named tuples so that you can integrate
        #with julia Tables.jl data analysis ecosystem
        results = Vector{NamedTuple{$varnames}}()
        for i in 1:nsteps
            Δ = f!(du, ϕ, u, 0)
            u = u .+ stepsize.*Δ
            push!(results, NamedTuple{$varnames}(u))
        end
        return results
    end
    end
end

eulers(bnsir, :eulsir, inf=0.3, rec=0.2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">quote
    <span class="sgr90">#= bilayerconversion.md:243 =#</span>
    function eulsir(state, nsteps::Integer, stepsize::Real)
        <span class="sgr90">#= bilayerconversion.md:243 =#</span>
        <span class="sgr90">#= bilayerconversion.md:244 =#</span>
        f!(du, ϕ, u, t) = begin
                <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:282 =#</span>
                begin
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:287 =#</span>
                    du .= 0.0
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:288 =#</span>
                    ϕ .= 1.0
                    ϕ[1] *= u[1]
                    ϕ[1] *= u[2]
                    ϕ[2] *= u[2]
                    ϕ[1] *= 0.3
                    ϕ[2] *= 0.2
                    du[1] -= ϕ[1]
                    du[2] -= ϕ[1]
                    du[2] -= ϕ[2]
                    du[2] += ϕ[1]
                    du[2] += ϕ[1]
                    du[3] += ϕ[2]
                    return du
                end
            end
        <span class="sgr90">#= bilayerconversion.md:246 =#</span>
        du = zeros(length(state))
        <span class="sgr90">#= bilayerconversion.md:247 =#</span>
        ϕ = ones(2)
        <span class="sgr90">#= bilayerconversion.md:248 =#</span>
        u = tuple(state...)
        <span class="sgr90">#= bilayerconversion.md:252 =#</span>
        results = Vector{NamedTuple{(:S, :I, :R)}}()
        <span class="sgr90">#= bilayerconversion.md:253 =#</span>
        for i = 1:nsteps
            <span class="sgr90">#= bilayerconversion.md:254 =#</span>
            Δ = f!(du, ϕ, u, 0)
            <span class="sgr90">#= bilayerconversion.md:255 =#</span>
            u = u .+ stepsize .* Δ
            <span class="sgr90">#= bilayerconversion.md:256 =#</span>
            push!(results, NamedTuple{(:S, :I, :R)}(u))
            <span class="sgr90">#= bilayerconversion.md:257 =#</span>
        end
        <span class="sgr90">#= bilayerconversion.md:258 =#</span>
        return results
    end
end</code></pre><pre><code class="language-julia hljs">eulseirqexp = eulers(bnquar, :eulseirq, exp=0.1, rec=0.03, qi=0.37, ill=0.7, qe=0.23, qr=0.03)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">quote
    <span class="sgr90">#= bilayerconversion.md:243 =#</span>
    function eulseirq(state, nsteps::Integer, stepsize::Real)
        <span class="sgr90">#= bilayerconversion.md:243 =#</span>
        <span class="sgr90">#= bilayerconversion.md:244 =#</span>
        f!(du, ϕ, u, t) = begin
                <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:282 =#</span>
                begin
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:287 =#</span>
                    du .= 0.0
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:288 =#</span>
                    ϕ .= 1.0
                    ϕ[1] *= u[1]
                    ϕ[1] *= u[2]
                    ϕ[2] *= u[3]
                    ϕ[3] *= u[2]
                    ϕ[4] *= u[3]
                    ϕ[5] *= u[2]
                    ϕ[6] *= u[5]
                    ϕ[1] *= 0.1
                    ϕ[2] *= 0.7
                    ϕ[3] *= 0.03
                    ϕ[4] *= 0.23
                    ϕ[5] *= 0.37
                    ϕ[6] *= 0.03
                    du[1] -= ϕ[1]
                    du[2] -= ϕ[1]
                    du[3] -= ϕ[2]
                    du[2] -= ϕ[3]
                    du[3] -= ϕ[4]
                    du[2] -= ϕ[5]
                    du[5] -= ϕ[6]
                    du[3] += ϕ[1]
                    du[2] += ϕ[1]
                    du[2] += ϕ[2]
                    du[4] += ϕ[3]
                    du[5] += ϕ[4]
                    du[5] += ϕ[5]
                    du[4] += ϕ[6]
                    return du
                end
            end
        <span class="sgr90">#= bilayerconversion.md:246 =#</span>
        du = zeros(length(state))
        <span class="sgr90">#= bilayerconversion.md:247 =#</span>
        ϕ = ones(6)
        <span class="sgr90">#= bilayerconversion.md:248 =#</span>
        u = tuple(state...)
        <span class="sgr90">#= bilayerconversion.md:252 =#</span>
        results = Vector{NamedTuple{(:S, :I, :E, :R, :Q)}}()
        <span class="sgr90">#= bilayerconversion.md:253 =#</span>
        for i = 1:nsteps
            <span class="sgr90">#= bilayerconversion.md:254 =#</span>
            Δ = f!(du, ϕ, u, 0)
            <span class="sgr90">#= bilayerconversion.md:255 =#</span>
            u = u .+ stepsize .* Δ
            <span class="sgr90">#= bilayerconversion.md:256 =#</span>
            push!(results, NamedTuple{(:S, :I, :E, :R, :Q)}(u))
            <span class="sgr90">#= bilayerconversion.md:257 =#</span>
        end
        <span class="sgr90">#= bilayerconversion.md:258 =#</span>
        return results
    end
end</code></pre><pre><code class="language-julia hljs">eulsirexp = eulers(bnsir, :eulsir, inf=0.3, rec=0.2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">quote
    <span class="sgr90">#= bilayerconversion.md:243 =#</span>
    function eulsir(state, nsteps::Integer, stepsize::Real)
        <span class="sgr90">#= bilayerconversion.md:243 =#</span>
        <span class="sgr90">#= bilayerconversion.md:244 =#</span>
        f!(du, ϕ, u, t) = begin
                <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:282 =#</span>
                begin
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:287 =#</span>
                    du .= 0.0
                    <span class="sgr90">#= /home/cuffaro.m/.julia/packages/AlgebraicPetri/WK5Qd/src/BilayerNetworks.jl:288 =#</span>
                    ϕ .= 1.0
                    ϕ[1] *= u[1]
                    ϕ[1] *= u[2]
                    ϕ[2] *= u[2]
                    ϕ[1] *= 0.3
                    ϕ[2] *= 0.2
                    du[1] -= ϕ[1]
                    du[2] -= ϕ[1]
                    du[2] -= ϕ[2]
                    du[2] += ϕ[1]
                    du[2] += ϕ[1]
                    du[3] += ϕ[2]
                    return du
                end
            end
        <span class="sgr90">#= bilayerconversion.md:246 =#</span>
        du = zeros(length(state))
        <span class="sgr90">#= bilayerconversion.md:247 =#</span>
        ϕ = ones(2)
        <span class="sgr90">#= bilayerconversion.md:248 =#</span>
        u = tuple(state...)
        <span class="sgr90">#= bilayerconversion.md:252 =#</span>
        results = Vector{NamedTuple{(:S, :I, :R)}}()
        <span class="sgr90">#= bilayerconversion.md:253 =#</span>
        for i = 1:nsteps
            <span class="sgr90">#= bilayerconversion.md:254 =#</span>
            Δ = f!(du, ϕ, u, 0)
            <span class="sgr90">#= bilayerconversion.md:255 =#</span>
            u = u .+ stepsize .* Δ
            <span class="sgr90">#= bilayerconversion.md:256 =#</span>
            push!(results, NamedTuple{(:S, :I, :R)}(u))
            <span class="sgr90">#= bilayerconversion.md:257 =#</span>
        end
        <span class="sgr90">#= bilayerconversion.md:258 =#</span>
        return results
    end
end</code></pre><pre><code class="language-julia hljs">eval(eulsirexp)
soln_codegen = eulsir((S=10.0, I=1, R=0), 30, 0.15)
pretty_table(soln_codegen)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─────────────┬─────────┬──────────┐
│           S │       I │        R │
├─────────────┼─────────┼──────────┤
│        9.55 │    1.42 │     0.03 │
│     8.93976 │ 1.98764 │   0.0726 │
│     8.14015 │ 2.72762 │ 0.132229 │
│       7.141 │ 3.64494 │ 0.214058 │
│     5.96972 │ 4.70688 │ 0.323406 │
│     4.70527 │ 5.83011 │ 0.464613 │
│     3.47082 │ 6.88966 │ 0.639516 │
│     2.39475 │ 7.75905 │ 0.846206 │
│      1.5586 │ 8.36242 │  1.07898 │
│    0.972087 │ 8.69806 │  1.32985 │
│      0.5916 │ 8.81761 │  1.59079 │
│    0.356858 │ 8.78782 │  1.85532 │
│    0.215737 │ 8.66531 │  2.11895 │
│    0.131613 │ 8.48947 │  2.37891 │
│   0.0813334 │ 8.28507 │   2.6336 │
│     0.05101 │ 8.06684 │  2.88215 │
│    0.032493 │ 7.84335 │  3.12416 │
│   0.0210246 │ 7.61952 │  3.35946 │
│   0.0138157 │ 7.39814 │  3.58804 │
│  0.00921622 │  7.1808 │  3.80999 │
│  0.00623813 │ 6.96835 │  4.02541 │
│    0.004282 │ 6.76126 │  4.23446 │
│  0.00297918 │ 6.55972 │   4.4373 │
│  0.00209976 │ 6.36381 │  4.63409 │
│  0.00149845 │  6.1735 │    4.825 │
│  0.00108217 │ 5.98871 │  5.01021 │
│ 0.000790533 │ 5.80934 │  5.18987 │
│ 0.000583872 │ 5.63527 │  5.36415 │
│ 0.000435809 │ 5.46636 │  5.53321 │
│ 0.000328606 │ 5.30247 │   5.6972 │
└─────────────┴─────────┴──────────┘</code></pre><pre><code class="language-julia hljs">eval(eulseirqexp)
soln_codegen = eulseirq((S=10.0, I=1, E=0, R=0, Q=0), 30, 0.15)
pretty_table(soln_codegen)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">┌─────────┬──────────┬──────────┬────────────┬──────────┐
│       S │        I │        E │          R │        Q │
├─────────┼──────────┼──────────┼────────────┼──────────┤
│    9.85 │     0.94 │     0.15 │     0.0045 │   0.0555 │
│ 9.71111 │  0.89935 │  0.26796 │ 0.00897975 │ 0.112595 │
│ 9.58011 │ 0.873525 │ 0.361585 │  0.0135335 │ 0.171247 │
│ 9.45458 │  0.85908 │ 0.436671 │   0.018235 │ 0.231432 │
│ 9.33275 │ 0.853385 │ 0.497589 │  0.0231423 │ 0.293134 │
│ 9.21328 │ 0.854429 │ 0.547642 │  0.0283016 │ 0.356345 │
│  9.0952 │ 0.860666 │ 0.589327 │  0.0337501 │ 0.421056 │
│ 8.97778 │ 0.870905 │ 0.624535 │  0.0395178 │  0.48726 │
│  8.8605 │ 0.884227 │ 0.654694 │  0.0456296 │ 0.554949 │
│ 8.74298 │ 0.899916 │ 0.680885 │  0.0521059 │ 0.624113 │
│ 8.62496 │ 0.917414 │ 0.703921 │   0.058964 │ 0.694741 │
│ 8.50627 │ 0.936281 │ 0.724414 │  0.0662187 │ 0.766816 │
│ 8.38681 │ 0.956168 │ 0.742822 │  0.0738826 │ 0.840321 │
│ 8.26652 │ 0.976794 │ 0.759486 │  0.0819668 │ 0.915234 │
│  8.1454 │ 0.997932 │ 0.774658 │   0.090481 │  0.99153 │
│ 8.02347 │   1.0194 │ 0.788522 │  0.0994336 │  1.06918 │
│ 7.90078 │  1.04103 │ 0.801209 │   0.108832 │  1.14815 │
│ 7.77741 │  1.06269 │ 0.812814 │   0.118683 │   1.2284 │
│ 7.65344 │  1.08428 │ 0.823402 │   0.128993 │  1.30989 │
│ 7.52896 │  1.10568 │ 0.833014 │   0.139767 │  1.39258 │
│ 7.40409 │   1.1268 │ 0.841677 │   0.151009 │  1.47642 │
│ 7.27895 │  1.14757 │ 0.849407 │   0.162724 │  1.56135 │
│ 7.15365 │   1.1679 │ 0.856211 │   0.174914 │  1.64732 │
│ 7.02833 │  1.18773 │ 0.862092 │   0.187582 │  1.73427 │
│ 6.90311 │  1.20699 │ 0.867046 │   0.200731 │  1.82212 │
│ 6.77813 │  1.22561 │ 0.871073 │   0.214362 │  1.91083 │
│ 6.65352 │  1.24353 │ 0.874168 │   0.228476 │   2.0003 │
│ 6.52941 │  1.26071 │  0.87633 │   0.243074 │  2.09047 │
│ 6.40594 │  1.27708 │ 0.877557 │   0.258154 │  2.18127 │
│ 6.28322 │   1.2926 │ 0.877852 │   0.273717 │  2.27261 │
└─────────┴──────────┴──────────┴────────────┴──────────┘</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../enzymes/enzyme_reactions/">« Cathepsin Enzyme Reactions</a><a class="docs-footer-nextpage" href="../stratification/">Stratification of COVID Models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Friday 12 January 2024 07:40">Friday 12 January 2024</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
